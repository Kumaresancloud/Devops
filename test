pipeline {
  agent { label 'awsoyer' }

  parameters {
    choice(name: 'ACCOUNT', choices: ['awsit', 'queen', 'take', 'king'], description: 'Select the Account')
    choice(name: 'Region', choices: ['us-east-1'], description: 'Select the Region')
    string(name: 'Instance_ID', description: 'Enter Instance ID')
  }

  stages {
    stage('Run for awsit only') {
      when {
        expression { params.ACCOUNT == "awsit" }
      }
      steps {
        sh "chmod +x -R ${env.WORKSPACE}"
        sh "./http/bash.sh"
      }
    }
  }

  post {
    always {
      emailext(
        attachLog: true,
        subject: 'Instance Type change job executed for ${Instance_ID}',
        body: """<h3>Instance Type change job executed for ${Instance_ID}</h3>
                 <p>JENKINS_JOB_URL: ${BUILD_URL}</p>""",
        attachmentsPattern: '*.csv',
        to: "kumaresan_gopalakrishnan@glic.com"
      )
    }
  }
}
